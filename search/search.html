<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <title>DATENAV - ìƒˆë¡œìš´ ì•½ì†</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        
            <nav>
                <button id="back-btn" class="nav-button">ë’¤ë¡œê°€ê¸°</button>
                <button id="menu-btn" class="nav-button">ë©”ë‰´</button>
            </nav>
        
    </header>

    <div class="content-section">
        <h2 class="section-title">í˜„ì¬ ìœ„ì¹˜: <span id="location">ìœ„ì¹˜ í™•ì¸ ì¤‘...</span></h2>
        
        <select id="category" class="category-select">
            <option value="all">ì „ì²´ ì¹´í…Œê³ ë¦¬</option>
            <option value="restaurant">ìŒì‹ì </option>
            <option value="cafe">ì¹´í˜</option>
            <option value="activity">ì•¡í‹°ë¹„í‹°</option>
        </select>

        <div id="map"></div>

        <h3 class="section-title">ì¦‰ì„ ì•½ì† ë¦¬ìŠ¤íŠ¸</h3>
        <ul class="appointment-list">
            <li class="appointment-item">ğŸ”¥ ë³´ë“œê²Œì„ ì•½ì† (3/4ëª…)</li>
            <li class="appointment-item">â˜• ì¹´í˜ ëª©ì„ (2/3ëª…)</li>
            <li class="appointment-item">ğŸ” ì €ë… ì‹ì‚¬ ëª©ì„ (1/4ëª…)</li>
        </ul>
    </div>
    <!-- <script src="script.js"></script> -->
    <script 
    type="text/javascript"
    src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=dqf8naqgxp&submodules=geocoder">
    </script>
    <script>
        let map;
        let samplePlaces = [];
        let categoryMarkers = [];

        // ìƒ˜í”Œ ë°ì´í„° ìƒì„±
        function generateSamplePlaces(baseLat, baseLng) {
            return [
                // ìŒì‹ì 
                { category: 'restaurant', name: 'ë§›ìˆëŠ” ì‹ë‹¹', lat: baseLat + 0.001, lng: baseLng + 0.001 },
                { category: 'restaurant', name: 'ê³ ê¸‰ ë ˆìŠ¤í† ë‘', lat: baseLat - 0.001, lng: baseLng + 0.002 },
                
                // ì¹´í˜
                { category: 'cafe', name: 'ì»¤í”¼ì•¤í¬ë¦¼', lat: baseLat + 0.002, lng: baseLng - 0.001 },
                { category: 'cafe', name: 'ë””ì €íŠ¸ì¹´í˜', lat: baseLat - 0.002, lng: baseLng - 0.002 },
                
                // ì•¡í‹°ë¹„í‹°
                { category: 'activity', name: 'ë³´ë“œê²Œì„ì¹´í˜', lat: baseLat + 0.003, lng: baseLng },
                { category: 'activity', name: 'ë°©íƒˆì¶œì¹´í˜', lat: baseLat, lng: baseLng + 0.003 }
            ];
        }

        // ì¹´í…Œê³ ë¦¬ ë³€ê²½ í•¸ë“¤ëŸ¬
        function handleCategoryChange() {
            const selectedCategory = document.getElementById('category').value;
            const filteredPlaces = selectedCategory === 'all' 
                ? samplePlaces 
                : samplePlaces.filter(place => place.category === selectedCategory);

            // ê¸°ì¡´ ë§ˆì»¤ ì œê±°
            categoryMarkers.forEach(marker => marker.setMap(null));
            categoryMarkers = [];

            // ìƒˆ ë§ˆì»¤ ì¶”ê°€
            filteredPlaces.forEach(place => {
                const marker = new naver.maps.Marker({
                    position: new naver.maps.LatLng(place.lat, place.lng),
                    map: map,
                    title: place.name,
                    icon: {
                        content: `<div style="background:${getCategoryColor(place.category)}; 
                                width:24px; height:24px; border-radius:50%; 
                                text-align:center; line-height:24px;">${getCategoryIcon(place.category)}</div>`,
                        size: new naver.maps.Size(24, 24),
                        anchor: new naver.maps.Point(12, 12)
                    }
                });
                categoryMarkers.push(marker);
            });
        }

        // ì¹´í…Œê³ ë¦¬ ì•„ì´ì½˜ ì„¤ì •
        function getCategoryIcon(category) {
            const icons = {
                restaurant: 'ğŸ´',
                cafe: 'â˜•',
                activity: 'ğŸ¯'
            };
            return icons[category] || 'ğŸ“';
        }

        // ì¹´í…Œê³ ë¦¬ ìƒ‰ìƒ ì„¤ì •
        function getCategoryColor(category) {
            const colors = {
                restaurant: '#ff4757',
                cafe: '#2ed573',
                activity: '#3742fa'
            };
            return colors[category] || '#666';
        }

        // ì§€ë„ ì´ˆê¸°í™”
        function initMap() {
            navigator.geolocation.getCurrentPosition(
                position => {
                    const lat = position.coords.latitude;
                    const lng = position.coords.longitude;

                    map = new naver.maps.Map('map', {
                        center: new naver.maps.LatLng(lat, lng),
                        zoom: 15
                    });

                    // ì‚¬ìš©ì ìœ„ì¹˜ ë§ˆì»¤
                    new naver.maps.Marker({
                        position: new naver.maps.LatLng(lat, lng),
                        map: map,
                        icon: {
                            content: '<div style="background:#3498db; width:20px; height:20px; border-radius:50%; border:2px solid white"></div>',
                            size: new naver.maps.Size(24, 24),
                            anchor: new naver.maps.Point(12, 12)
                        }
                    });

                    document.getElementById('location').textContent = 
                        `ìœ„ë„: ${lat.toFixed(4)}, ê²½ë„: ${lng.toFixed(4)}`;

                    // ìƒ˜í”Œ ë°ì´í„° ìƒì„± ë° ì´ˆê¸° í‘œì‹œ
                    samplePlaces = generateSamplePlaces(lat, lng);
                    handleCategoryChange();
                },
                error => {
                    // ìœ„ì¹˜ í—ˆìš© ì•ˆ í•  ê²½ìš° ì„œìš¸ ì¢Œí‘œ ì‚¬ìš©
                    const defaultPosition = { coords: { latitude: 37.5665, longitude: 126.9780 }};
                    initMapWithPosition(defaultPosition);
                    document.getElementById('location').textContent = 'ìœ„ì¹˜ ì •ë³´ ì—†ìŒ (ì„œìš¸ ì‹œì²­ ê¸°ì¤€)';
                }
            );
        }

        document.getElementById('category').addEventListener('change', handleCategoryChange);
        document.getElementById('back-btn').addEventListener('click', () => window.history.back());

        window.onload = function() {
            if (!window.naver) {
                alert('ì§€ë„ API ë¡œë“œ ì‹¤íŒ¨');
                return;
            }
            initMap();
        };
    </script>
</body>
</html>

